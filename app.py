import streamlit as st
import matplotlib.pyplot as plt
import numpy as np
import altair as alt
import pandas as pd

st.title("ğŸ¬ ç”µå½±ç‰ˆã€Šæ€æƒ³è¾©è¯åŒºåŸŸã€‹æµ‹è¯•é¢˜")
st.write("è¯·ç›´è§‰ä½œç­”ï¼Œä¸è¦æ€è€ƒå¤ªä¹…ï¼Œæ¯é¢˜é€‰å‡ºä½ æœ€è®¤åŒçš„é€‰é¡¹ã€‚")

# å®šä¹‰æ‰€æœ‰ç»´åº¦åˆå§‹å€¼
dimensions = {
    "éå¥³æƒ â†” å¥³æƒ": 0,
    "ä¿å®ˆ â†” å¼€æ”¾": 0,
    "å•†ä¸š â†” ç‹¬ç«‹": 0,
    "ç»å…¸ â†” å…ˆé”‹": 0,
    "å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 0
}

# é—®é¢˜å’Œé€‰é¡¹ç»“æ„ï¼Œæ¯ä¸ªé€‰é¡¹å¸¦æœ‰å¯¹ç»´åº¦çš„å½±å“
questions = [
    {
        "question": "1. ä½ è¦ç­–åˆ’ä¸€åœºç”µå½±å±•ï¼Œä½ ä¼šé€‰æ‹©å“ªä¸ªä¸»é¢˜ï¼Ÿ",
        "options": {
            "A. â€˜æ—¶ä»£çš„å‘å–Šâ€™â€”â€”èšç„¦ç¤¾ä¼šè¿åŠ¨ã€å¥³æ€§æƒåˆ©ã€å·¥äººé˜¶çº§æŠ—äº‰ï¼Œå±•æ˜ å¦‚ã€Šå¥¹è¯´ã€‹ã€Šç‡ƒçƒ§å¥³å­çš„è‚–åƒã€‹ã€Šæµªæ½®ã€‹ã€‚": {"éå¥³æƒ â†” å¥³æƒ": 2, "ä¿å®ˆ â†” å¼€æ”¾": 2, "å•†ä¸š â†” ç‹¬ç«‹": 1},
            "B. â€˜é“¶æ²³å½¼å²¸â€™â€”â€”æ¢ç´¢ç§‘æŠ€ã€äººç±»æœªæ¥ã€äººå·¥æ™ºèƒ½ä¼¦ç†ï¼Œå±•æ˜ å¦‚ã€Š2001 å¤ªç©ºæ¼«æ¸¸ã€‹ã€Šé“¶ç¿¼æ€æ‰‹ã€‹ã€Šæ²™ä¸˜ã€‹ã€‚": {"ç»å…¸ â†” å…ˆé”‹": 2, "å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1, "å•†ä¸š â†” ç‹¬ç«‹": -1},
            "C. â€˜ç°å®çš„é‡é‡â€™â€”â€”å‰–æç¤¾ä¼šé˜¶å±‚ã€æ°‘æ—å†²çªã€é“å¾·å›°å¢ƒï¼Œå±•æ˜ å¦‚ã€Šå¯„ç”Ÿè™«ã€‹ã€Šæ¨æ‹¿ã€‹ã€Šå°å·å®¶æ—ã€‹ã€‚": {"ä¿å®ˆ â†” å¼€æ”¾": 2, "å•†ä¸š â†” ç‹¬ç«‹": 2},
            "D. â€˜å…‰å½±é—äº§â€™â€”â€”è‡´æ•¬ç”µå½±å†å²ã€ç»å…¸å™äº‹ã€ä¼ ç»Ÿç”µå½±ç¾å­¦ï¼Œå±•æ˜ å¦‚ã€Šæ•™çˆ¶ã€‹ã€Šä¹±ä¸–ä½³äººã€‹ã€Šæ—¥å‡ºã€‹ã€‚": {"ç»å…¸ â†” å…ˆé”‹": -2, "ä¿å®ˆ â†” å¼€æ”¾": -2, "éå¥³æƒ â†” å¥³æƒ": -1}
        }
    },
    {
        "question": "2. ä½ æ›´å®¹æ˜“åœ¨ä»¥ä¸‹å“ªç§æƒ…å¢ƒä¸­è½æ³ªï¼Ÿ",
        "options": {
            "A. å¥³æ€§è§’è‰²åœ¨ä¸å…¬å¹³ä¸–ç•Œä¸­æŒ£æ‰æˆ–åæŠ—": {"éå¥³æƒ â†” å¥³æƒ": 2, "ä¿å®ˆ â†” å¼€æ”¾": 1},
            "B. LGBT è§’è‰²åœ¨ç¤¾ä¼šåè§ä¸­æŒ£æ‰": {"ä¿å®ˆ â†” å¼€æ”¾": 2},
            "C. ç»å…¸ç”µå½±çš„è‡´æ•¬æˆ–å¤åˆ»": {"ç»å…¸ â†” å…ˆé”‹": -2, "ä¿å®ˆ â†” å¼€æ”¾": -1},
            "D. ä¸€éƒ¨ç”µå½±ç”¨çœŸæŒšçš„æƒ…æ„Ÿå±•ç°çˆ±æƒ…ã€äº²æƒ…å’Œå®¶åº­çº½å¸¦": {"ä¿å®ˆ â†” å¼€æ”¾": -2, "éå¥³æƒ â†” å¥³æƒ": -1}
        }
    },
    {
        "question": "3. ä½ æœ€è®¨åŒå“ªç§ç”µå½±è¯„ä»·ï¼Ÿ",
        "options": {
            "A. â€œè¿™éƒ¨ç”µå½±å¤ªå¥³æƒäº†ï¼Œçœ‹ä¸ä¸‹å»ã€‚â€": {"éå¥³æƒ â†” å¥³æƒ": 2, "ä¿å®ˆ â†” å¼€æ”¾": 1},
            "B. â€œè¿™ç”µå½±ä¸å°Šé‡ä¼ ç»Ÿä»·å€¼è§‚ã€‚â€": {"ä¿å®ˆ â†” å¼€æ”¾": 2, "éå¥³æƒ â†” å¥³æƒ": 1},
            "C. â€œè¿™ç”µå½±ä¸å¥½çœ‹ï¼Œæˆ‘çœ‹ä¸æ‡‚ã€‚â€": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 2},
            "D. â€œè¿™ç§ç”µå½±å¥—è·¯å¤ªè€äº†ï¼Œæ²¡æ„æ€ã€‚â€": {"ç»å…¸ â†” å…ˆé”‹": 2}
        }
    },
    {
        "question": "4. å¦‚æœä½ æˆä¸ºå¯¼æ¼”ï¼Œä½ æœ€æƒ³æ‹å“ªç§ç±»å‹çš„ç”µå½±ï¼Ÿ",
        "options": {
            "A. å…ˆé”‹å®éªŒç”µå½±ï¼Œå¦‚ã€Šåœ£å±±ã€‹": {"ç»å…¸ â†” å…ˆé”‹": 2, "å•†ä¸š â†” ç‹¬ç«‹": 2, "å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1},
            "B. å•†ä¸šå¤§ç‰‡ï¼Œå¦‚ã€Šé˜¿å‡¡è¾¾ã€‹": {"å•†ä¸š â†” ç‹¬ç«‹": -2, "å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": -1},
            "C. è®²è¿°å°‘æ•°æ°‘æ—/ç§»æ°‘æ•…äº‹ï¼Œå¦‚ã€Šåˆ«å‘Šè¯‰å¥¹ã€‹ã€Šæ‘˜é‡‘å¥‡ç¼˜ã€‹": {"ä¿å®ˆ â†” å¼€æ”¾": 2, "éå¥³æƒ â†” å¥³æƒ": 1, "å•†ä¸š â†” ç‹¬ç«‹": -1},
            "D. è¡¨ç°å¥³æ€§åšéŸ§ä½†å¼ºè°ƒå®¶åº­ä»·å€¼è§‚ï¼Œå¦‚ã€Šæ¯äº²ã€‹ã€Šç”Ÿæ´»å¤šç¾å¥½ã€‹": {"éå¥³æƒ â†” å¥³æƒ": 1, "ä¿å®ˆ â†” å¼€æ”¾": -2}
        }
    },
    {
        "question": "5. ä½ æ€ä¹ˆçœ‹å¾…â€œæ”¿æ²»æ­£ç¡®â€åœ¨ç”µå½±ä¸­çš„å½±å“ï¼Ÿ",
        "options": {
            "A. ç”µå½±ä¸è¯¥è¿åˆæ”¿æ²»æ­£ç¡®": {"éå¥³æƒ â†” å¥³æƒ": -2, "ä¿å®ˆ â†” å¼€æ”¾": -2},
            "B. ç”µå½±éœ€è¦æ‰¿æ‹…ç¤¾ä¼šè´£ä»»": {"éå¥³æƒ â†” å¥³æƒ": 2, "ä¿å®ˆ â†” å¼€æ”¾": 2},
            "C. åªè¦æ˜¯å¥½ä½œå“ï¼Œä¸åœ¨æ„": {"ç»å…¸ â†” å…ˆé”‹": 2, "å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 2, "éå¥³æƒ â†” å¥³æƒ": -1, "ä¿å®ˆ â†” å¼€æ”¾": -1},
            "D. æˆ‘æ›´å…³æ³¨ç”µå½±æœ¬èº«çš„æŠ€æœ¯å’Œå™äº‹": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1, "éå¥³æƒ â†” å¥³æƒ": -1, "ä¿å®ˆ â†” å¼€æ”¾": -1}
        }
    },
        {
        "question": "6. ä½ å¯¹ç”µå½±å¥–é¡¹çš„çœ‹æ³•ï¼Ÿ",
        "options": {
            "A. ç”µå½±èŠ‚è¯„å®¡æ ‡å‡†æœ‰åè§ï¼Œä¸èƒ½å®Œå…¨ä»£è¡¨è´¨é‡": {"ç»å…¸ â†” å…ˆé”‹": 1, "ä¿å®ˆ â†” å¼€æ”¾": 1},
            "B. ç”µå½±å¥–é¡¹åº”è¯¥æ›´å¤šè¡¨å½°æ–‡åŒ–é—äº§ç”µå½±ï¼Œå¦‚ã€Šéœ¸ç‹åˆ«å§¬ã€‹ã€Šå§è™è—é¾™ã€‹": {"ä¿å®ˆ â†” å¼€æ”¾": -1},
            "C. ç”µå½±å¥–é¡¹è¶Šæ¥è¶Šå—å¸‚åœºå’Œæ”¿æ²»å½±å“ï¼Œæƒå¨æ€§é™ä½": {"å•†ä¸š â†” ç‹¬ç«‹": 1, "ä¿å®ˆ â†” å¼€æ”¾": -1},
            "D. æˆ‘æ›´å…³æ³¨è§‚ä¼—è¯„ä»·ï¼Œå¥–é¡¹å¯¹æˆ‘æ¥è¯´ä¸é‡è¦": {"å•†ä¸š â†” ç‹¬ç«‹": -1}
        }
    },
    {
        "question": "7. ä½ æ›´æ„¿æ„åœ¨å“ªç§ç¯å¢ƒä¸‹çœ‹ç”µå½±ï¼Ÿ",
        "options": {
            "A. è‰ºæœ¯å½±é™¢ï¼Œæ²‰æµ¸ä½“éªŒ": {"å•†ä¸š â†” ç‹¬ç«‹": 1},
            "B. ç”µå½±é™¢å¤§é“¶å¹•": {"ç»å…¸ â†” å…ˆé”‹": 1},
            "C. åœ¨å®¶ç‹¬è‡ªè§‚çœ‹ï¼ŒæŸ¥èµ„æ–™ã€åšç¬”è®°": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1},
            "D. å’Œæœ‹å‹ä¸€èµ·çœ‹å•†ä¸šå¤§ç‰‡ï¼Œæ„Ÿå—æ°›å›´": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": -1}
        }
    },
    {
        "question": "8. ä½ å¯¹ç¿»æ‹ç»å…¸ç”µå½±çš„çœ‹æ³•ï¼Ÿ",
        "options": {
            "A. ç»å…¸å°±æ˜¯ç»å…¸ï¼Œç¿»æ‹æ¯«æ— å¿…è¦": {"ç»å…¸ â†” å…ˆé”‹": -1},
            "B. ç¿»æ‹å¯ä»¥è®©ç”µå½±é€‚åº”ç°ä»£ä»·å€¼è§‚ï¼Œå¦‚å¥³æ€§ç‰ˆã€Šé­”é¬¼ç»ˆç»“è€…ã€‹": {"ç»å…¸ â†” å…ˆé”‹": 1, "ä¿å®ˆ â†” å¼€æ”¾": 1},
            "C. å…³é”®çœ‹å¯¼æ¼”åˆ›æ–°èƒ½åŠ›": {"å•†ä¸š â†” ç‹¬ç«‹": 1},
            "D. ç»å…¸ç”µå½±åº”è¯¥è®©è§‚ä¼—è‡ªå·±å»æ¢ç´¢ï¼Œè€Œä¸æ˜¯ç¿»æ‹": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1}
        }
    },
    {
        "question": "9. ä½ æœ€ä¸èƒ½å¿å—å“ªç§è§‚å½±ä½“éªŒï¼Ÿ",
        "options": {
            "A. ç”µå½±é™¢é‡Œè§‚ä¼—ä¸€ç›´åœ¨è¯´è¯ã€ç©æ‰‹æœºï¼Œå½±å“è§‚å½±ä½“éªŒã€‚": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 2},
            "B. ç”µå½±èŠ‚ä¸Šçœ‹åˆ°ä¸€äº›æ•…æ„æŒ‘æˆ˜è§‚ä¼—è€æ€§çš„â€˜æ™¦æ¶©â€™è‰ºæœ¯ç‰‡ï¼Œæ„Ÿè§‰æ˜¯è‡ªå—¨ã€‚": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": -1},
            "C. æµåª’ä½“ä¸Šçœ‹åˆ°çš„ç”µå½±è¢«å‰ªè¾‘æˆ–ä¿®æ”¹ï¼Œå¤±å»äº†å¯¼æ¼”çš„åŸå§‹åˆ›ä½œæ„å›¾ã€‚": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1, "ç»å…¸ â†” å…ˆé”‹": -1},
            "D. å¥½è±åç”µå½±é‡Œå……æ–¥ç€æ— æ„ä¹‰çš„çˆ†ç‚¸ã€å¤§åˆ¶ä½œï¼Œä½†æ•…äº‹åƒç¯‡ä¸€å¾‹ã€‚": {"å•†ä¸š â†” ç‹¬ç«‹": 2}
        }
    },
    {
        "question": "10. ä½ å¯¹å¥½è±åçš„â€˜æ¼«å¨åŒ–â€™æ€ä¹ˆçœ‹ï¼Ÿ",
        "options": {
            "A. è¿™æ˜¯ç”µå½±å·¥ä¸šçš„å€’é€€ï¼Œåº”è¯¥æ¢å¤ç‹¬ç«‹ç”µå½±çš„åœ°ä½": {"å•†ä¸š â†” ç‹¬ç«‹": 2},
            "B. æ¼«å¨ç”µå½±å¾ˆæˆåŠŸï¼Œèƒ½å¸¦æ¥ä¼˜ç§€çš„è§†è§‰ä½“éªŒ": {"å•†ä¸š â†” ç‹¬ç«‹": -1},
            "C. å¥½è±ååº”è¯¥æœ‰æ›´å¤šéè‹±è¯­å›½å®¶çš„ç”µå½±åŠ å…¥": {"ä¿å®ˆ â†” å¼€æ”¾": 1},
            "D. è¶…çº§è‹±é›„ç‰‡ä¹Ÿæ˜¯ç”µå½±çš„ä¸€ç§ï¼Œæ²¡å¿…è¦æ’æ–¥": {"ç»å…¸ â†” å…ˆé”‹": -1}
        }
    },
    {
        "question": "11. ä½ æ€ä¹ˆçœ‹å¾…é»‘ç™½ç”µå½±ï¼Ÿ",
        "options": {
            "A. é»‘ç™½ç”µå½±æ›´æœ‰è´¨æ„Ÿï¼Œåº”è¯¥è¢«æ›´å¤šäººæ¬£èµ": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1},
            "B. ç”µå½±åº”è¯¥ä¸æ–­è¿›åŒ–ï¼Œé»‘ç™½ç‰‡æ˜¯è¿‡å»çš„é—äº§": {"å•†ä¸š â†” ç‹¬ç«‹": -1},
            "C. é»‘ç™½æ˜¯ä¸€ç§è‰ºæœ¯è¡¨è¾¾æ–¹å¼ï¼Œä¸åº”æ¶ˆå¤±": {"ç»å…¸ â†” å…ˆé”‹": -1},
            "D. ç°å®é¢˜æçš„é»‘ç™½ç‰‡èƒ½å¢åŠ çœŸå®æ„Ÿ": {"å•†ä¸š â†” ç‹¬ç«‹": 1}
        }
    },
    {
        "question": "12. ä½ æ›´å–œæ¬¢çš„å¯¼æ¼”æ˜¯å“ªç§ç±»å‹ï¼Ÿ",
        "options": {
            "A. çªç ´å™äº‹è§„åˆ™çš„å¯¼æ¼”ï¼Œå¦‚æˆˆè¾¾å°”ã€æ‹‰æ–¯Â·å†¯Â·æå°”": {"ç»å…¸ â†” å…ˆé”‹": 1},
            "B. ç¥¨æˆ¿å¤§å¯¼æ¼”ï¼Œå¦‚è¯ºå…°ã€æ–¯çš®å°”ä¼¯æ ¼": {"å•†ä¸š â†” ç‹¬ç«‹": -1},
            "C. å…³æ³¨ç¤¾ä¼šé—®é¢˜çš„å¯¼æ¼”ï¼Œå¦‚æ˜¯æè£•å’Œã€ææ²§ä¸œ": {"ä¿å®ˆ â†” å¼€æ”¾": 1},
            "D. ç»å…¸å¤§å¸ˆï¼Œå¦‚åº“å¸ƒé‡Œå…‹ã€é»‘æ³½æ˜": {"ç»å…¸ â†” å…ˆé”‹": -1}
        }
    },
    {
        "question": "13. ä½ æ€ä¹ˆçœ‹å¾…ç”µå½±ä¸­çš„æš´åŠ›ç¾å­¦ï¼Ÿ",
        "options": {
            "A. ç”µå½±åº”çœŸå®å‘ˆç°æš´åŠ›çš„æœ¬è´¨ï¼Œè€Œä¸æ˜¯ç¾åŒ–å®ƒ": {"ä¿å®ˆ â†” å¼€æ”¾": 1},
            "B. æš´åŠ›ç¾å­¦æ˜¯ç±»å‹ç‰‡çš„ä¸€éƒ¨åˆ†ï¼Œåº”å½“è¢«è§†ä¸ºä¸€ç§ç”µå½±ä¼ ç»Ÿ": {"ç»å…¸ â†” å…ˆé”‹": -1},
            "C. æš´åŠ›åªæ˜¯ç”µå½±å¹»æƒ³çš„ä¸€éƒ¨åˆ†ï¼Œæ²¡å¿…è¦è¿‡åº¦é“å¾·åŒ–": {"ä¿å®ˆ â†” å¼€æ”¾": -1},
            "D. ç”µå½±å¯ä»¥é€šè¿‡è§£æ„æš´åŠ›å½¢å¼ï¼ŒæŒ‘æˆ˜è§‚ä¼—çš„è§‚å½±ä¹ æƒ¯": {"ç»å…¸ â†” å…ˆé”‹": 1}
        }
    },
    {
        "question": "14. ä½ æ€ä¹ˆçœ‹å¾…åŠ¨ç”»ç”µå½±ï¼Ÿ",
        "options": {
            "A. åŠ¨ç”»ç”µå½±ä¸åªæ˜¯ç»™å­©å­çœ‹çš„ï¼Œæ¯”å¦‚å®«å´éªã€ä»Šæ•çš„ä½œå“": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": 1},
            "B. åŠ¨ç”»ç”µå½±æ˜¯æœ€æœ‰å•†ä¸šæ½œåŠ›çš„ç”µå½±ç±»å‹": {"å•†ä¸š â†” ç‹¬ç«‹": -1},
            "C. åŠ¨ç”»å¯ä»¥æ˜¯è‰ºæœ¯ï¼Œæ¯”å¦‚ã€Šç–¯ç‹‚ä¸–ç•Œã€‹": {"ç»å…¸ â†” å…ˆé”‹": 1},
            "D. ç»å…¸çš„æ‰‹ç»˜åŠ¨ç”»æ¯” 3D åŠ¨ç”»æ›´æœ‰é­…åŠ›": {"ç»å…¸ â†” å…ˆé”‹": -1}
        }
    },
    {
        "question": "15. ä½ æ€ä¹ˆçœ‹å¾…ç¥¨æˆ¿ä¸ç”µå½±è´¨é‡çš„å…³ç³»ï¼Ÿ",
        "options": {
            "A. ç¥¨æˆ¿ä¸èƒ½ä»£è¡¨ç”µå½±è´¨é‡": {"å•†ä¸š â†” ç‹¬ç«‹": 1},
            "B. ç¥¨æˆ¿è¶Šé«˜ï¼Œè¯´æ˜è§‚ä¼—è¶Šå–œæ¬¢": {"å•†ä¸š â†” ç‹¬ç«‹": -1},
            "C. ç”µå½±åº”è¯¥æœåŠ¡å¤§ä¼—ï¼Œè€Œä¸æ˜¯ç²¾è‹±åœˆå­": {"å¤§ä¼—å½±è¿· â†” ç¡¬æ ¸å½±è¿·": -1},
            "D. ç»å…¸ç”µå½±ä¸ä¸€å®šæ˜¯ç¥¨æˆ¿å¤§ç‰‡": {"ç»å…¸ â†” å…ˆé”‹": -1}
        }
    }
]

# ç”¨æˆ·ä½œç­”
total_scores = {}
total_scores_absol = {}
for dim in dimensions:
    total_scores[dim] = 0
    total_scores_absol[dim] = 0

for idx, q in enumerate(questions):
    st.subheader(q["question"])
    choice = st.radio("é€‰æ‹©ä½ çš„ç­”æ¡ˆï¼š", list(q["options"].keys()), key=f"q{idx}")
    effects = q["options"][choice]
    for dim, value in effects.items():
        total_scores[dim] += value
        total_scores_absol[dim] += abs(value)

# æäº¤åå±•ç¤ºç»“æœ
if st.button("æäº¤æµ‹è¯•å¹¶æŸ¥çœ‹ç»“æœ"):
    st.markdown("## ğŸ§­ ä½ çš„ä»·å€¼è§‚å€¾å‘å¦‚ä¸‹ï¼š")

    normalized_scores = {}
    for dim, score in total_scores.items():
        denom = total_scores_absol[dim] if total_scores_absol[dim] != 0 else 1
        normalized_scores[dim] = score / denom

    # æ˜¾ç¤ºå¾—åˆ†æ•°å€¼
    for dim, val in normalized_scores.items():
        st.write(f"**{dim}ï¼š** {val:+.2f}")

    # æ„å»º dataframe
    df = pd.DataFrame({
        'ç»´åº¦': list(normalized_scores.keys()),
        'å¾—åˆ†': list(normalized_scores.values())
    })

    # ä½¿ç”¨ Altair ç”»å½©è‰²æ¡å½¢å›¾ï¼Œå·¦çº¢å³ç»¿ï¼Œå«0å‚è€ƒçº¿
    chart = alt.Chart(df).mark_bar().encode(
        x=alt.X('å¾—åˆ†:Q', scale=alt.Scale(domain=[-1, 1])),
        y=alt.Y('ç»´åº¦:N', sort='-x'),
        color=alt.condition(
            'datum.å¾—åˆ† >= 0',
            alt.value('#1f77b4'),  # è“è‰²ï¼šåå³
            alt.value('#ff7f0e')   # æ©™è‰²ï¼šåå·¦
        )
    ).properties(
        height=400
    )

    # æ·»åŠ  0 è½´çº¿
    zero_line = alt.Chart(pd.DataFrame({'å¾—åˆ†': [0]})).mark_rule(color='black', strokeDash=[3,3]).encode(
        x='å¾—åˆ†:Q'
    )

    st.altair_chart(chart + zero_line, use_container_width=True)